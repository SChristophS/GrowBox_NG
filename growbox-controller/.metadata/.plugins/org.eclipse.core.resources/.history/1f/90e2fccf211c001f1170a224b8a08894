#ifndef __MQTT_PAL_H__
#define __MQTT_PAL_H__

#include <stddef.h>
#include <stdint.h>
#include "wizchip_conf.h"
#include "socket.h"
#include <stm32f1xx_hal.h> // FÃ¼gen Sie diese Zeile hinzu, um HAL_GetTick zu deklarieren

// Define the types used by the library
typedef int mqtt_pal_socket_handle;
typedef uint32_t mqtt_pal_time_t;

// Define ssize_t if not defined
#ifndef ssize_t
typedef int ssize_t;
#endif

// Mutex type (not used in this example, but required for the library)
typedef int mqtt_pal_mutex_t;

// Network functions for MQTT-C
static inline ssize_t mqtt_pal_sendall(mqtt_pal_socket_handle fd, const void* buf, size_t len, int flags) {
    return send(fd, (uint8_t*)buf, len);
}

static inline ssize_t mqtt_pal_recvall(mqtt_pal_socket_handle fd, void* buf, size_t bufsz, int flags) {
    return recv(fd, buf, bufsz);
}

// Time functions for MQTT-C
static inline mqtt_pal_time_t mqtt_pal_time(void) {
    return HAL_GetTick(); // Use HAL_GetTick() to get the system time in milliseconds
}

#endif /* __MQTT_PAL_H__ */
